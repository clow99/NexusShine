# clow99/NexusShine — Architecture

Generated by NexusDocs from a scan of the repository at ref `main`.

## Architecture

NexusShine is a Next.js 16 application that manages cleaning tasks and inspections across branches and locations. It uses:

- **Next.js App Router** under `src/app`
- **Prisma** with a MySQL-compatible database (via `mysql2`)
- **NextAuth** for authentication (with `@auth/prisma-adapter`)
- **Tailwind CSS 4** for styling
- **Nodemailer / Resend** for email-related flows

### Repository layout (top-level)

- `src/` (50 files)
- `public/` (8 files)
- `docs/` (4 files)
- `.dockerignore` (1 file)
- `.editorconfig` (1 file)
- `.gitattributes` (1 file)
- `.gitignore` (1 file)
- `.prettierrc` (1 file)
- `README.md` (1 file)
- `build.log` (1 file)
- `env.local.example` (1 file)
- `eslint.config.mjs` (1 file)

### `src/` structure (high level)

The `src` directory contains the application code:

- `src/app/`
  - Next.js **App Router** entry point.
  - Contains route segments for pages and API routes.
  - `src/app/api/**/route.js` implement REST-style endpoints for domain entities and actions:
    - `/api/auth/[...nextauth]` — authentication via NextAuth.
    - `/api/users` — CRUD for users.
    - `/api/branches` — CRUD for branches.
    - `/api/locations` — CRUD for locations.
    - `/api/bathrooms` — CRUD for bathrooms.
    - `/api/tasks` — CRUD for tasks.
    - `/api/settings` — application-level settings.
    - `/api/theme` — theme updates.
    - `/api/clean` — cleaning-related operations.
    - `/api/inspection`, `/api/inspection/clear`, `/api/inspection/remind` — inspection workflows.
    - `/api/validate` — validation of user codes or similar tokens.
- Other common subdirectories (if present) typically include:
  - `src/components/` — shared UI components.
  - `src/lib/` or `src/utils/` — helpers, Prisma client, and integration utilities.
  - `src/styles/` — Tailwind / global styles.

### Data and domain model

The core domain is organized around a few main entities, persisted via Prisma:

- **User**
  - Represents an application user.
  - Used by NextAuth for authentication and authorization.
- **Branch**
  - A top-level organizational unit (e.g., a store or site).
  - Holds metadata such as name, address, and notification emails.
- **Location**
  - A sub-area within a branch (e.g., floor, section).
  - Linked to a `Branch`.
- **Bathroom**
  - A specific bathroom within a `Location`.
  - Includes attributes like gender and status.
- **Task**
  - Cleaning or inspection tasks associated with bathrooms/locations.
- **Settings / Theme**
  - Global configuration and UI theme preferences.

These models are exposed and manipulated through the corresponding `/api/*` routes listed above.

### Authentication and authorization

- **NextAuth** is configured under `/api/auth/[...nextauth]`.
- **Prisma adapter** (`@auth/prisma-adapter`) persists user and session data.
- Certain routes (e.g., user and settings management) expect **admin privileges**; authorization checks are typically enforced in the relevant API route handlers.

### Persistence and infrastructure

- **Database**
  - Configured via `DATABASE_URL` (see `env.local.example`).
  - Uses `@prisma/client` and `prisma` for schema and migrations.
- **Email**
  - `nodemailer` and/or `resend` are used for sending emails (e.g., reminders, notifications), especially in inspection-related flows.

### Frontend and styling

- **React 19** with **Next.js 16** App Router.
- **Tailwind CSS 4** for utility-first styling.
- **Framer Motion** for animations and transitions.
- The UI consumes the `/api/*` endpoints via `fetch`/`axios` to display and manage:
  - Branches and locations
  - Bathrooms and their status
  - Tasks and inspection schedules
  - User and settings management
  - Theme selection

### Middleware and configuration

- `middleware.js`
  - Next.js middleware for cross-cutting concerns (e.g., auth checks, redirects, or localization) applied to selected routes.
- `next.config.mjs` (if present)
  - Next.js configuration (image domains, experimental flags, etc.).
- `eslint.config.mjs`, `.prettierrc`, `.editorconfig`
  - Linting and formatting configuration for consistent code style.

### Docs

- `docs/`
  - Contains project documentation, including this architecture overview.
  - Additional files may cover setup, API usage, or contribution guidelines.

### Notes

- Add deeper module-level docs for key directories (e.g. `src/`, `docs/`), including:
  - A map of `src/app` route segments and their UI responsibilities.
  - A brief description of shared components and utilities.
- Document Prisma schema and relationships explicitly once the schema file is available.