# clow99/NexusShine — User Guide

Generated by NexusDocs from a scan of the repository at ref `main`.

## User Guide

NexusShine is a web application for managing cleaning tasks and inspections across different branches and locations.

### Prerequisites

- Node.js (version compatible with Next.js 16)
- A MySQL-compatible database
- Access to configure environment variables

### Getting started

1. **Clone the repository**

   ```bash
   git clone <repo-url>
   cd NexusShine
   ```

2. **Configure environment variables**

   - Copy the example file:

     ```bash
     cp env.local.example .env.local
     ```

   - Edit `.env.local` and set at least:

     - `DATABASE_URL` — Database connection string  
       Example:  
       `mysql://user:password@localhost:3306/mydb`

   - Add any other variables required by your deployment environment.

3. **Install dependencies**

   ```bash
   npm install
   ```

4. **Run database migrations (if applicable)**

   If you are using Prisma with the configured `DATABASE_URL`, run:

   ```bash
   npx prisma migrate deploy
   ```

   or for local development:

   ```bash
   npx prisma migrate dev
   ```

5. **Start dev server**

   ```bash
   npm run dev
   ```

   The app will typically be available at `http://localhost:3000`.

### Running in production

1. Build the application:

   ```bash
   npm run build
   ```

2. Start the production server:

   ```bash
   npm run start
   ```

Ensure `DATABASE_URL` and any other required environment variables are set in your production environment.

### Useful commands

- `npm run dev` — `next dev`
- `npm run build` — `next build`
- `npm run start` — `next start`
- `npm run lint` — `eslint`
- `npm run test` — `node --test`
- `npm run smoke` — `npm run lint && node --test tests/smoke.test.js`

### Core concepts

NexusShine revolves around a few core entities:

- **Users** — People who log in and manage or perform cleaning tasks.
- **Branches** — High-level organizational units (e.g., different offices or sites).
- **Locations** — Areas within branches (e.g., floors, departments).
- **Bathrooms** — Specific bathroom facilities within locations.
- **Tasks** — Cleaning or inspection tasks associated with locations/bathrooms.

### Authentication and access

Authentication is handled via NextAuth at:

- `/api/auth/[...nextauth]`

Some operations (such as managing users, branches, or settings) may require admin privileges. If you encounter authorization errors, verify that your user has the appropriate role or permissions.

### Working with the application

Once the app is running:

1. **Sign in**

   - Navigate to the app in your browser.
   - Use the configured authentication method (see project-specific auth setup if documented elsewhere).

2. **Manage branches and locations**

   - Create and update branches (e.g., different sites).
   - Add locations under each branch (e.g., floors, zones).

3. **Manage bathrooms**

   - Define bathrooms under locations, including attributes such as name and gender.
   - Use these to attach cleaning and inspection tasks.

4. **Manage tasks**

   - Create tasks that describe cleaning or inspection activities.
   - Assign tasks to relevant locations/bathrooms.

5. **Run inspections and cleaning workflows**

   - Use the UI to trigger or record inspections and cleaning.
   - Behind the scenes, the following API routes are used:
     - `/api/clean` — Perform/record cleaning operations.
     - `/api/inspection` — Perform/record inspections.
     - `/api/inspection/clear` — Clear inspection status.
     - `/api/inspection/remind` — Send inspection reminders.

6. **Adjust settings and theme**

   - `/api/settings` — Application-level settings (e.g., notification behavior).
   - `/api/theme` — Change the application theme (limited to predefined themes).

### API overview (for advanced users)

If you are integrating or debugging, these are the main API endpoints:

- `/api/users` — Manage user entities (`GET`, `POST`, `PATCH`, `DELETE`)
- `/api/branches` — Manage branch entities (`GET`, `POST`, `PATCH`, `DELETE`)
- `/api/locations` — Manage location entities (`GET`, `POST`, `PATCH`, `DELETE`)
- `/api/bathrooms` — Manage bathroom entities (`GET`, `POST`, `PATCH`, `DELETE`)
- `/api/tasks` — Manage task entities (`GET`, `POST`, `PATCH`, `DELETE`)
- `/api/settings` — Get/update settings (`GET`, `PATCH`)
- `/api/theme` — Update theme (`PATCH`)
- `/api/validate` — Validate user codes (`POST`)

Use these only if you are comfortable working with HTTP APIs and understand the authentication/authorization model of your deployment.

### Troubleshooting and gotchas

- **Database connectivity**

  - Ensure `DATABASE_URL` is correctly set and reachable.
  - Verify that migrations have been applied to the target database.

- **Permissions**

  - Some operations require admin privileges. If actions fail with authorization errors, confirm your user’s role.

- **Theme changes**

  - Theme options are restricted to predefined themes. Passing unsupported values to `/api/theme` may result in validation errors.

- **Tests and smoke checks**

  - Run the full test suite:

    ```bash
    npm run test
    ```

  - Run a quick smoke check (lint + targeted tests):

    ```bash
    npm run smoke
    ```